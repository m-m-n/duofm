# duofm - Unifies Orthodox File Manipulation

Go言語で書かれたターミナルベースの2画面ファイルマネージャです。クラシックなファイルマネージャにインスパイアされ、vimスタイルのキーバインドを採用しています。

## 機能

### コア機能
- **2画面インターフェース**: 2つのディレクトリを並べて表示
- **vimスタイルキーバインド**: hjkl + 矢印キーによるナビゲーション
- **ファイル操作**: コピー、移動、削除、リネーム
- **複数ファイルマーク**: Spaceで複数選択してバッチ操作
- **シンボリックリンク対応**: ターゲット表示、壊れたリンクの検出
- **上書き処理**: 競合時にスキップ、上書き、リネームを選択

### ナビゲーション
- **検索・フィルタ**: インクリメンタル検索(`/`)、正規表現検索(`Ctrl+F`)
- **隠しファイル**: `Ctrl+H`で表示切替
- **クイックナビゲーション**: ホーム(`~`)、前のディレクトリ(`-`)、ペイン同期(`=`)
- **ソート機能**: 名前、サイズ、日付（ライブプレビュー付き）
- **ブックマーク**: よく使うディレクトリを保存してジャンプ（`b`/`B`）
- **スマートカーソル**: 親ディレクトリに戻る際にカーソル位置を記憶

### 表示
- **3つの表示モード**: Minimal、Basic（サイズ+日付）、Detail（パーミッション+所有者）
- **Unicode対応**: 日本語、中国語、韓国語、絵文字の適切な表示
- **コンテキストメニュー**: `@`でアクション選択
- **ヘルプシステム**: `?`でスクロール可能なキーバインド一覧（カラーパレット付き）

### 外部連携
- **外部ビューア**: $PAGERでファイル表示（`v`キー）
- **外部エディタ**: $EDITORでファイル編集（`e`キー）
- **シェルコマンド**: `!`キーでコマンド実行
- **作業ディレクトリ**: 外部アプリはファイルのディレクトリで開く

### カスタマイズ
- **設定ファイル**: `~/.config/duofm/config.toml`（自動生成）
- **キーバインドカスタマイズ**: 修飾キー対応（Ctrl、Shift、Alt）で全キー変更可能
- **カラーテーマ**: 全UI要素の256色カスタマイズ
- **ブックマーク**: 設定ファイルに永続化

## スクリーンショット

```
┌─────────────────────────────────────────────────────────────┐
│ duofm v0.1.0                                                │
├──────────────────────────┬──────────────────────────────────┤
│ ~/projects/duofm         │ ~                                │
│──────────────────────────│──────────────────────────────────│
│ ../                      │ ../                              │
│ cmd/                     │ Documents/                       │
│ internal/                │ Downloads/                       │
│ test/                    │ Pictures/                        │
│ go.mod                   │ .bashrc                          │
│ go.sum                   │ .profile                         │
│ Makefile                 │                                  │
└──────────────────────────┴──────────────────────────────────┘
│ 1/7                                      ?:help q:quit      │
└─────────────────────────────────────────────────────────────┘
```

## インストール

### 必要条件

- Go 1.21以上

### ソースからビルド

```bash
# リポジトリをクローン
git clone https://github.com/sakura/duofm.git
cd duofm

# 依存関係をインストール
go mod download

# ビルド
make build

# 実行
./duofm
```

### システムへのインストール

```bash
# $GOPATH/binにインストール
make install

# どこからでも実行可能
duofm
```

## 使い方

### ナビゲーション

| キー | アクション |
|------|-----------|
| `j` / `↓` | カーソルを下に移動 |
| `k` / `↑` | カーソルを上に移動 |
| `h` / `←` | 左ペインに移動 / 親ディレクトリ |
| `l` / `→` | 右ペインに移動 / 親ディレクトリ |
| `Enter` | ディレクトリに入る / ファイルを開く |
| `~` | ホームディレクトリへ |
| `-` | 前のディレクトリへ |
| `=` | ペインを同期 |

### ファイル操作

| キー | アクション |
|------|-----------|
| `c` | 反対側のペインにコピー |
| `m` | 反対側のペインに移動 |
| `d` | 削除（確認あり） |
| `r` | リネーム |
| `n` | 新規ファイル作成 |
| `N` | 新規ディレクトリ作成 |
| `Space` | マーク/マーク解除 |

### 検索

| キー | アクション |
|------|-----------|
| `/` | インクリメンタル検索 |
| `Ctrl+F` | 正規表現検索 |

### 表示

| キー | アクション |
|------|-----------|
| `i` | 表示モード切替 |
| `Ctrl+H` | 隠しファイル表示切替 |
| `s` | ソート設定 |

### 外部連携

| キー | アクション |
|------|-----------|
| `v` | ビューアで開く |
| `e` | エディタで開く |
| `!` | シェルコマンド実行 |
| `@` | コンテキストメニュー |

### その他

| キー | アクション |
|------|-----------|
| `?` | ヘルプを表示 |
| `q` | 終了 |
| `F5` / `Ctrl+R` | 更新 |

## 設定

設定ファイルは `~/.config/duofm/config.toml` に配置します。

### キーバインド設定例

```toml
[keybindings]
move_down = ["J", "Down"]
move_up = ["K", "Up"]
copy = ["C"]
quit = ["Q"]
```

### カラー設定例

```toml
[colors]
cursor_bg = 39        # カーソル背景色（青）
directory_fg = 39     # ディレクトリ（青）
symlink_fg = 14       # シンボリックリンク（シアン）
```

## 開発

### プロジェクト構成

```
duofm/
├── cmd/duofm/           # アプリケーションエントリーポイント
├── internal/
│   ├── ui/             # TUIコンポーネント (Bubble Tea)
│   ├── fs/             # ファイルシステム操作
│   └── config/         # 設定ファイル処理
├── doc/                # ドキュメント
└── Makefile            # ビルド自動化
```

### テスト実行

```bash
make test           # 全テスト実行
make test-coverage  # カバレッジ付き
```

### コード品質

```bash
make fmt   # フォーマット
make vet   # 静的解析
make lint  # リンター
```

## 技術スタック

- **言語**: Go 1.21+
- **TUIフレームワーク**: [Bubble Tea](https://github.com/charmbracelet/bubbletea)
- **スタイリング**: [Lip Gloss](https://github.com/charmbracelet/lipgloss)
- **設定ファイル**: [TOML](https://github.com/BurntSushi/toml)

## 謝辞

- [ranger](https://github.com/ranger/ranger)と[nnn](https://github.com/jarun/nnn)にインスパイアされました
- [Bubble Tea](https://github.com/charmbracelet/bubbletea)と[Lip Gloss](https://github.com/charmbracelet/lipgloss)で構築

---

Made with ❤️ by the duofm team
