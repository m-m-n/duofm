# 要件定義書: 外部ビューア終了後のカーソル位置保持

## 概要

lessやvimなどの外部アプリケーションでファイルを閲覧・編集した後、duofmに戻った際にカーソル位置が先頭にリセットされる問題を修正する。

## 問題の詳細

### 現在の動作

1. ファイルリスト内でファイルを選択（例：10番目のファイル）
2. `v`キーまたは`Enter`キーでlessを起動
3. lessで内容を確認し、`q`で終了
4. duofmに戻ると、カーソルがリストの先頭（1番目）に移動している

### 期待される動作

1. ファイルリスト内でファイルを選択（例：10番目のファイル）
2. `v`キーまたは`Enter`キーでlessを起動
3. lessで内容を確認し、`q`で終了
4. duofmに戻ると、カーソルは元の位置（10番目）を維持している

## 原因分析

`execFinishedMsg`のハンドリングで`LoadDirectory()`を呼び出しており、このメソッドは常に`cursor = 0`にリセットする設計になっている。

```go
// model.go:387-392
case execFinishedMsg:
    // 外部コマンド完了
    // 両ペインを再読み込みして変更を反映
    m.getActivePane().LoadDirectory()
    m.getInactivePane().LoadDirectory()
```

```go
// pane.go:112-113
p.cursor = 0
p.scrollOffset = 0
```

## 要件

### 機能要件

1. 外部ビューア（less）終了後、アクティブペインのカーソル位置を維持する
2. 外部エディタ（vim）終了後、アクティブペインのカーソル位置を維持する
3. 選択していたファイルが消失した場合は、カーソルを先頭に戻す
4. ディレクトリ内容は正しく再読み込みする（編集による変更を反映）
5. 非アクティブペインのカーソル位置も維持する

### 非機能要件

1. 既存の`LoadDirectory()`メソッドの動作は変更しない（ディレクトリ移動時はカーソルリセットが正しい動作）
2. パフォーマンスに影響を与えない

## 対象外

- スクロール位置の厳密な復元（カーソル位置が画面内に収まれば可）

## 受け入れ基準

1. lessで閲覧後、同じファイルにカーソルが位置している
2. vimで編集後、同じファイルにカーソルが位置している
3. 選択していたファイルが消失した場合、カーソルは先頭に戻る
4. 非アクティブペインのカーソル位置も維持される
5. 既存のディレクトリ移動機能に影響しない
6. 既存のテストがすべてパスする
