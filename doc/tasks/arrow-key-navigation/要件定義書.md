# 要件定義書: カーソルキー（矢印キー）ナビゲーション対応

## 概要

duofmにカーソルキー（↑↓←→）によるナビゲーション操作を追加する。
既存のhjklキー操作と完全に同じ動作を実現し、ユーザーの好みに応じた操作方法を提供する。

## ビジネス要件

### 目的
- Vimキーバインドに慣れていないユーザーでも直感的に操作できるようにする
- 一般的なファイルマネージャーと同様の操作感を提供する

### 対象ユーザー
- duofmの全ユーザー
- 特にVimキーバインドに不慣れなユーザー

## ユースケース

### UC-1: メインビューでのカーソル移動
- **アクター**: ユーザー
- **前提条件**: ダイアログが開いていない状態
- **操作**: ↑キーまたは↓キーを押す
- **結果**: カーソルが上下に移動する（kキー/jキーと同じ動作）

### UC-2: メインビューでのペイン切り替え/親ディレクトリ移動
- **アクター**: ユーザー
- **前提条件**: ダイアログが開いていない状態
- **操作**: ←キーまたは→キーを押す
- **結果**: ペイン切り替えまたは親ディレクトリへ移動（hキー/lキーと同じ動作）

### UC-3: コンテキストメニューでのカーソル移動
- **アクター**: ユーザー
- **前提条件**: コンテキストメニューが開いている状態
- **操作**: ↑キーまたは↓キーを押す
- **結果**: メニュー項目間をカーソル移動（kキー/jキーと同じ動作）

## 機能要件

### FR-1: メインビューでのカーソルキー対応

| キー | 動作 | 対応するVimキー |
|------|------|-----------------|
| ↑ (Up) | カーソルを上に移動 | k |
| ↓ (Down) | カーソルを下に移動 | j |
| ← (Left) | 左ペイン時: 親ディレクトリへ / 右ペイン時: 左ペインへ切り替え | h |
| → (Right) | 右ペイン時: 親ディレクトリへ / 左ペイン時: 右ペインへ切り替え | l |

### FR-2: ダイアログでのカーソルキー対応

| ダイアログ | カーソルキー対応 | 備考 |
|------------|------------------|------|
| コンテキストメニュー | ↑↓ | 既に対応済み（確認のみ） |
| ヘルプダイアログ | 不要 | 操作なし（Escで閉じるのみ） |
| 確認ダイアログ | 不要 | y/n/Escのみ |
| エラーダイアログ | 不要 | Escで閉じるのみ |

### FR-3: ヘルプダイアログの更新
- カーソルキーが使用可能であることをヘルプに記載する

## 非機能要件

### NFR-1: 互換性
- 既存のhjklキー操作に影響を与えない
- 両方のキー操作を同時にサポートする

### NFR-2: パフォーマンス
- キー入力のレスポンスに遅延を生じさせない

## UI/UX要件

### ヘルプ画面の更新
```
Navigation
  j/k/↑/↓  : move cursor down/up
  h/l/←/→  : move to left/right pane or parent directory
```

## 制約条件

- Bubble Teaフレームワークの `tea.KeyMsg` を使用
- カーソルキーは `"up"`, `"down"`, `"left"`, `"right"` として認識される

## 成功基準

1. ↑↓←→キーでhjklと同じナビゲーションが可能
2. すべての既存テストがパス
3. ダイアログ内でもカーソルキーが期待通りに動作

## テストシナリオ

### TS-1: メインビューでの上下移動
1. アプリケーションを起動
2. ↓キーを押す → カーソルが下に移動
3. ↑キーを押す → カーソルが上に移動

### TS-2: メインビューでのペイン切り替え
1. 左ペインがアクティブな状態で→キーを押す → 右ペインがアクティブになる
2. 右ペインがアクティブな状態で←キーを押す → 左ペインがアクティブになる

### TS-3: 親ディレクトリへの移動
1. 左ペインがアクティブな状態で←キーを押す → 親ディレクトリに移動
2. 右ペインがアクティブな状態で→キーを押す → 親ディレクトリに移動

### TS-4: コンテキストメニューでの操作
1. @キーでコンテキストメニューを開く
2. ↓キーを押す → カーソルが下に移動
3. ↑キーを押す → カーソルが上に移動

## 確認済み事項

- カーソルキーはすべて（↑↓←→）対応する
- ダイアログでもhjklと同じ挙動にする
- カーソルキーの動作はhjklと完全に同じ
